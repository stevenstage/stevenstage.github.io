---
layout: post
author: ldy
title: TSPulse: Dual Space Tiny Pre-Trained Models for Rapid Time-Series Analysis
date: 2025-09-01
categories: [thoughts]
tags: [foundation model, time series, fft] # TAG 名称应始终为小写
math: true
---
## 前言
这次带来一篇我个人觉得认为模型架构做的非常新颖的时序基础模型：[TSPulse](http://arxiv.org/pdf/2505.13033v1)。由于工业界下游任务的特殊性，我们不能仅关注时序基础模型的预测能力，更需要下游任务的多样性，如分类、插补、异常检测等等，因此模型需要有足够的能力处理多任务问题，并尽可能和业界的工作对齐。在之前的分析中我们发现，在时间序列这个庞大的群体中，模型越大仅能有限制的提升效果，反倒是对数据处理的越合适，模型效果将会越好，这其实在启发我们，或许越深入的数据处理逻辑越能得到更好的效果。

[paper](http://arxiv.org/pdf/2505.13033v1)
[code](https://github.com/ibm-granite/granite-tsfm/tree/main/tsfm_public/models/tspulse)

## 模型架构
先来个概览图：

### masking
模型输入：$\mathbf{X} \in \mathbb{R}^{S \times C}$，其中$S$为序列长度，$C$为通道个数，它代表了多变量的时间序列数据。在掩码阶段，我们先把他分为N个不重叠的patches，长度为pl，此时掩码好的序列为：$\hat{\mathbf{X}} \in \mathbb{R}^{S \times C}$。具体来说，原始的时序模型，如MOMENT，掩码方式为block masking，也就是加入可学习的mask token $\mathbf{M} \in \mathbb{R}^{1 \times pl}$。但这个模型采用的是hybird masking，通过比率掩蔽全部或者部分patch，它在patch这个角度定义mask token，模型多样性上要比在潜入空间定义mask token要更好，也更符合现实世界中的插补任务（如心率缺失补充问题）

### 归一化
采用常用的Revin归一化，将未掩码的序列输出为${\mathbf{X}_m} \in \mathbb{R}^{S \times C}$

### FFT

